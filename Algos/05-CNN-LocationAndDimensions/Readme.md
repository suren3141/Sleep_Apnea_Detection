This is the algorithm in R10 HTC Paper
